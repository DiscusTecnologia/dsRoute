/*
 dsRoute <https://github.com/DiscusTecnologia/dsRoute/>
 Released under the MIT license
 Author: Rodrigo Ramos
*/
dsRoute=new function(){routes={},elRouteView="#content",templatesUrlLoaded=[],templatesLoaded={},this.setElRouteView=function(el){elRouteView=el},this.setRoutes=function(routes){function parseHash(newHash,oldHash){crossroads.parse(newHash)}this.routes=routes;for(var route in routes)crossroads.addRoute(route);crossroads.routed.add(function(request,data,first){controller=routes[data.route._pattern].controller,url=routes[data.route._pattern].templateUrl,nocache=void 0!=routes[data.route._pattern].nocache&&routes[data.route._pattern].nocache,$.inArray(data.route._pattern,templatesUrlLoaded)==-1||nocache?$.ajax({url:url,type:"GET",success:function(remoteData,status,xhr){templatesUrlLoaded.push(data.route._pattern),templatesLoaded[data.route._pattern]=remoteData,$(elRouteView).html(remoteData)},error:function(xhr,textStatus){void 0!=routes[xhr.status]?hasher.setHash(xhr.status):void 0!=routes.default?hasher.setHash("default"):$(elRouteView).html('<div style="background-color: #F2DEDE; color: #843534"><h3>Error for route "'+request+'"</h3><p>Status code error: '+xhr.status+" "+xhr.statusText+"</p></div>")}}):$(elRouteView).html(templatesLoaded[data.route._pattern]),controller.apply(this,data.params)}),crossroads.bypassed.add(function(request){void 0!=routes[404]?hasher.setHash("404"):void 0!=routes.default?hasher.setHash("default"):$(elRouteView).html('<div style="background-color: #F2DEDE; color: #843534"><h3>Error for route "'+request+'"</h3><p>Route not found: error code 404</p></div>')}),hasher.initialized.add(parseHash),hasher.changed.add(parseHash),hasher.init()}};